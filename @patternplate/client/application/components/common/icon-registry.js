'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');

var _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

exports.withRegistry = withRegistry;

var _lodash = require('lodash');

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _reactSideEffect = require('react-side-effect');

var _reactSideEffect2 = _interopRequireDefault(_reactSideEffect);

var _icons = require('./icons');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function withRegistry(Component) {
	return (0, _reactSideEffect2.default)(toState, onChange)(Component);
}

function toState(propsList) {
	var list = propsList.map(function (item) {
		return item.symbol || 'placeholder';
	}).sort();
	var symbols = (0, _lodash.uniq)(list);
	return _react2.default.createElement(IconRegistry, { symbols: symbols });
}

function onChange(registry) {
	var element = getRegistryMountPoint();
	_reactDom2.default.render(registry, element);
}

function getRegistryMountPoint() {
	var _global = global,
	    document = _global.document;

	var found = document.querySelector('[data-icon-registry]');
	if (found) {
		return found;
	}

	var created = document.createElement('div');
	created.setAttribute('data-icon-registry', true);
	document.body.appendChild(created);
	return created;
}

var IconRegistry = function (_React$Component) {
	(0, _inherits3.default)(IconRegistry, _React$Component);

	function IconRegistry() {
		(0, _classCallCheck3.default)(this, IconRegistry);
		return (0, _possibleConstructorReturn3.default)(this, (IconRegistry.__proto__ || (0, _getPrototypeOf2.default)(IconRegistry)).apply(this, arguments));
	}

	(0, _createClass3.default)(IconRegistry, [{
		key: 'render',
		value: function render() {
			var props = this.props;

			return _react2.default.createElement(
				'svg',
				{ style: { display: 'none' } },
				props.symbols.map(function (symbol) {
					var creator = _icons.icons[symbol] || _icons.icons.placeholder;
					var paths = creator() || [];
					return _react2.default.createElement(_Symbol, { id: symbol, key: symbol, definition: paths });
				})
			);
		}
	}]);
	return IconRegistry;
}(_react2.default.Component);

IconRegistry.propTypes = {
	symbols: _react.PropTypes.arrayOf(_react.PropTypes.oneOf(_icons.iconNames)).isRequired
};

IconRegistry.defaultProps = {
	symbols: []
};

function _Symbol(props) {
	var paths = Array.isArray(props.definition) ? props.definition : [props.definition];

	return _react2.default.createElement(
		'symbol',
		{
			id: props.id,
			viewBox: '0 0 24 24'
		},
		paths.map(function (path) {
			return _react2.default.createElement(Path, { definition: path, key: path });
		})
	);
}

_Symbol.propTypes = {
	definition: _react.PropTypes.oneOfType([_react.PropTypes.string, _react.PropTypes.object, _react.PropTypes.array]).isRequired,
	id: _react.PropTypes.string.isRequired
};

function Path(props) {
	var definition = props.definition;

	var def = typeof definition === 'string' ? { d: definition } : definition;
	var tagName = def.tagName,
	    p = (0, _objectWithoutProperties3.default)(def, ['tagName']);

	var Component = tagName || 'path';
	return _react2.default.createElement(Component, p);
}

Path.propTypes = {
	definition: _react.PropTypes.oneOfType([_react.PropTypes.string, _react.PropTypes.object]).isRequired
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NvdXJjZS9hcHBsaWNhdGlvbi9jb21wb25lbnRzL2NvbW1vbi9pY29uLXJlZ2lzdHJ5LmpzIl0sIm5hbWVzIjpbIndpdGhSZWdpc3RyeSIsIkNvbXBvbmVudCIsInRvU3RhdGUiLCJvbkNoYW5nZSIsInByb3BzTGlzdCIsImxpc3QiLCJtYXAiLCJpdGVtIiwic3ltYm9sIiwic29ydCIsInN5bWJvbHMiLCJyZWdpc3RyeSIsImVsZW1lbnQiLCJnZXRSZWdpc3RyeU1vdW50UG9pbnQiLCJyZW5kZXIiLCJnbG9iYWwiLCJkb2N1bWVudCIsImZvdW5kIiwicXVlcnlTZWxlY3RvciIsImNyZWF0ZWQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYm9keSIsImFwcGVuZENoaWxkIiwiSWNvblJlZ2lzdHJ5IiwicHJvcHMiLCJkaXNwbGF5IiwiY3JlYXRvciIsInBsYWNlaG9sZGVyIiwicGF0aHMiLCJwcm9wVHlwZXMiLCJhcnJheU9mIiwib25lT2YiLCJpc1JlcXVpcmVkIiwiZGVmYXVsdFByb3BzIiwiU3ltYm9sIiwiQXJyYXkiLCJpc0FycmF5IiwiZGVmaW5pdGlvbiIsImlkIiwicGF0aCIsIm9uZU9mVHlwZSIsInN0cmluZyIsIm9iamVjdCIsImFycmF5IiwiUGF0aCIsImRlZiIsImQiLCJ0YWdOYW1lIiwicCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1FBTWdCQSxZLEdBQUFBLFk7O0FBTmhCOztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRU8sU0FBU0EsWUFBVCxDQUFzQkMsU0FBdEIsRUFBaUM7QUFDdkMsUUFBTywrQkFBZUMsT0FBZixFQUF3QkMsUUFBeEIsRUFBa0NGLFNBQWxDLENBQVA7QUFDQTs7QUFFRCxTQUFTQyxPQUFULENBQWlCRSxTQUFqQixFQUE0QjtBQUMzQixLQUFNQyxPQUFPRCxVQUNYRSxHQURXLENBQ1A7QUFBQSxTQUFRQyxLQUFLQyxNQUFMLElBQWUs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U0FBTCxHQUFpQjtBQUNoQlEsYUFBWSxpQkFBRUcsU0FBRixDQUFZLENBQUMsaUJBQUVDLE1BQUgsRUFBVyxpQkFBRUMsTUFBYixDQUFaLEVBQWtDVjtBQUQ5QixDQUFqQiIsImZpbGUiOiJpY29uLXJlZ2lzdHJ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHt1bmlxfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IFJlYWN0LCB7UHJvcFR5cGVzIGFzIHR9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHdpdGhTaWRlRWZmZWN0IGZyb20gJ3JlYWN0LXNpZGUtZWZmZWN0JztcbmltcG9ydCB7aWNvbnMsIGljb25OYW1lc30gZnJvbSAnLi9pY29ucyc7XG5cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUmVnaXN0cnkoQ29tcG9uZW50KSB7XG5cdHJldHVybiB3aXRoU2lkZUVmZmVjdCh0b1N0YXRlLCBvbkNoYW5nZSkoQ29tcG9uZW50KTtcbn1cblxuZnVuY3Rpb24gdG9TdGF0ZShwcm9wc0xpc3QpIHtcblx0Y29uc3QgbGlzdCA9IHByb3BzTGlzdFxuXHRcdC5tYXAoaXRlbSA9PiBpdGVtLnN5bWJvbCB8fCAncGxhY2Vob2xkZXInKVxuXHRcdC5zb3J0KCk7XG5cdGNvbnN0IHN5bWJvbHMgPSB1bmlxKGxpc3QpO1xuXHRyZXR1cm4gPEljb25SZWdpc3RyeSBzeW1ib2xzPXtzeW1ib2xzfS8+O1xufVxuXG5mdW5jdGlvbiBvbkNoYW5nZShyZWdpc3RyeSkge1xuXHRjb25zdCBlbGVtZW50ID0gZ2V0UmVnaXN0cnlNb3VudFBvaW50KCk7XG5cdFJlYWN0RE9NLnJlbmRlcihyZWdpc3RyeSwgZWxlbWVudCk7XG59XG5cbmZ1bmN0aW9uIGdldFJlZ2lzdHJ5TW91bnRQb2ludCgpIHtcblx0Y29uc3Qge2RvY3VtZW50fSA9IGdsb2JhbDtcblx0Y29uc3QgZm91bmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1pY29uLXJlZ2lzdHJ5XScpO1xuXHRpZiAoZm91bmQpIHtcblx0XHRyZXR1cm4gZm91bmQ7XG5cdH1cblxuXHRjb25zdCBjcmVhdGVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdGNyZWF0ZWQuc2V0QXR0cmlidXRlKCdkYXRhLWljb24tcmVnaXN0cnknLCB0cnVlKTtcblx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjcmVhdGVkKTtcblx0cmV0dXJuIGNyZWF0ZWQ7XG59XG5cbmNsYXNzIEljb25SZWdpc3RyeSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG5cdHJlbmRlcigpIHtcblx0XHRjb25zdCB7cHJvcHN9ID0gdGhpcztcblx0XHRyZXR1cm4gKFxuXHRcdFx0PHN2ZyBzdHlsZT17e2Rpc3BsYXk6ICdub25lJ319PlxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cHJvcHMuc3ltYm9sc1xuXHRcdFx0XHRcdFx0Lm1hcChzeW1ib2wgPT4ge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjcmVhdG9yID0gaWNvbnNbc3ltYm9sXSB8fCBpY29ucy5wbGFjZWhvbGRlcjtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGF0aHMgPSBjcmVhdG9yKCkgfHwgW107XG5cdFx0XHRcdFx0XHRcdHJldHVybiA8U3ltYm9sIGlkPXtzeW1ib2x9IGtleT17c3ltYm9sfSBkZWZpbml0aW9uPXtwYXRoc30vPjtcblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdDwvc3ZnPlxuXHRcdCk7XG5cdH1cbn1cblxuSWNvblJlZ2lzdHJ5LnByb3BUeXBlcyA9IHtcblx0c3ltYm9sczogdC5hcnJheU9mKHQub25lT2YoaWNvbk5hbWVzKSkuaXNSZXF1aXJlZFxufTtcblxuSWNvblJlZ2lzdHJ5LmRlZmF1bHRQcm9wcyA9IHtcblx0c3ltYm9sczogW11cbn07XG5cbmZ1bmN0aW9uIFN5bWJvbChwcm9wcykge1xuXHRjb25zdCBwYXRocyA9IEFycmF5LmlzQXJyYXkocHJvcHMuZGVmaW5pdGlvbikgP1xuXHRcdHByb3BzLmRlZmluaXRpb24gOlxuXHRcdFtwcm9wcy5kZWZpbml0aW9uXTtcblxuXHRyZXR1cm4gKFxuXHRcdDxzeW1ib2xcblx0XHRcdGlkPXtwcm9wcy5pZH1cblx0XHRcdHZpZXdCb3g9XCIwIDAgMjQgMjRcIlxuXHRcdFx0PlxuXHRcdFx0e1xuXHRcdFx0XHRwYXRocy5tYXAocGF0aCA9PiA8UGF0aCBkZWZpbml0aW9uPXtwYXRofSBrZXk9e3BhdGh9Lz4pXG5cdFx0XHR9XG5cdFx0PC9zeW1ib2w+XG5cdCk7XG59XG5cblN5bWJvbC5wcm9wVHlwZXMgPSB7XG5cdGRlZmluaXRpb246IHQub25lT2ZUeXBlKFt0LnN0cmluZywgdC5vYmplY3QsIHQuYXJyYXldKS5pc1JlcXVpcmVkLFxuXHRpZDogdC5zdHJpbmcuaXNSZXF1aXJlZFxufTtcblxuZnVuY3Rpb24gUGF0aChwcm9wcykge1xuXHRjb25zdCB7ZGVmaW5pdGlvbn0gPSBwcm9wcztcblx0Y29uc3QgZGVmID0gdHlwZW9mIGRlZmluaXRpb24gPT09ICdzdHJpbmcnID8ge2Q6IGRlZmluaXRpb259IDogZGVmaW5pdGlvbjtcblx0Y29uc3Qge3RhZ05hbWUsIC4uLnB9ID0gZGVmO1xuXHRjb25zdCBDb21wb25lbnQgPSB0YWdOYW1lIHx8ICdwYXRoJztcblx0cmV0dXJuIDxDb21wb25lbnQgey4uLnB9Lz47XG59XG5cblBhdGgucHJvcFR5cGVzID0ge1xuXHRkZWZpbml0aW9uOiB0Lm9uZU9mVHlwZShbdC5zdHJpbmcsIHQub2JqZWN0XSkuaXNSZXF1aXJlZFxufTtcbiJdfQ==